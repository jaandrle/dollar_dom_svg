<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <title>$dom_svg — Examples</title>
    <script type="text/javascript">function init(e){"use strict";const t={empty:function(e){let t=e.childNodes.length;for(;t--;)e.removeChild(e.lastChild)},insertAfter:function(e,t){const{parentNode:n,nextSibling:r}=t;r?n.insertBefore(e,r):n.appendChild(e)},replace:function(e,n){t.insertAfter(n,e),e.remove()}},n=function(){let e={add:function(){return e},component:function(){return e},mount:n,update:r,ondestroy:o,share:{mount:n,update:r,destroy:function(){return e=null,null},ondestroy:o,isStatic:function(){return!0}}};return e;function n(e,n="childLast"){switch(n){case"replace":e.remove();break;case"replaceContent":t.empty(e)}return null}function r(){return!0}function o(){return!0}}();t.component=function(e,r,{mapUpdate:o,namespace_group:i}={}){if(!e||"EMPTY"===e||"empty"===e)return n;let s,l;"svg"===e&&(i="SVG"),"SVG"===i?(s=t.assignNS.bind(null,"SVG"),l=document.createElementNS.bind(document,"http://www.w3.org/2000/svg")):(s=t.assign,l=document.createElement.bind(document));let c=null,u=null,a=null,f=null;const d=document.createDocumentFragment();let p,h=[],g=0,b=[];let m={add:k,addText:function(e,t=0){w(t);const n=document.createTextNode(e);let r=h[g]=j().appendChild(n);return g+=1,Object.assign({oninit:function(e){return e(r),m}},m)},component:function({mount:e,update:t,isStatic:n},r=0){w(r),h[g]=e(j()),n()||(c||(c=S()),c.registerComponent(t));return g+=1,m},dynamicComponent:function(e,t,n=0){w(n);const r=j();let o=null,i=null,s=null;function l(e){i=e,s=s?i.mount(s,"replace"):i.mount(r)}return y.onupdate(m,r,e,function(e){o=t.call(r,l,i,e,o)})},setShift:function(e=0){let t;e?b.splice(b.length+1+e):(t=b.pop(),b.push(t,t));return m},mount:v,update:C,ondestroy:O,share:{mount:v,update:C,destroy:N,ondestroy:O,isStatic:function(){return!c}}},y={getReference:function(e,t){return t},on:function(e,t,...n){return n.forEach(([t,n])=>e[t].apply(this,n)),e},oninit:function(e,t,n){return n(t),e},onmount:function(e,t,n){return a||(a=new Map),a.set(t,n),e},onupdate:function(e,t,n,r){return n?(c||(c=S()),s(t,c.register(t,n,r)),e):e}};return k(e,r);function k(e,t,n=0){w(n),t=t||{};const r=l(e);g?h[g]=j().appendChild(r):p=h[0]=d.appendChild(r);let o=h[g];g+=1,s(o,t);const i=Object.assign({},m);return i.getReference=y.getReference.bind(null,i,o),i.on=y.on.bind(null,i,o),i.oninit=y.oninit.bind(null,i,o),i.onmount=y.onmount.bind(null,i,o),i.onupdate=y.onupdate.bind(null,i,o),i}function v(e,n="childLast"){f&&f.disconnect();const r=!d.firstChild&&p?p:d;let o;switch(n){case"replace":o=e.parentNode,t.replace(e,r);break;case"replaceContent":t.empty(e),e.appendChild(r),o=e;break;case"before":(o=e.parentNode).insertBefore(r,e);break;case"after":t.insertAfter(r,e),o=e.parentNode;break;default:"childFirst"===n&&e.childNodes.length?e.insertBefore(r,e.childNodes[0]):e.appendChild(r),o=e}return(f=new MutationObserver(e=>e.forEach(function(e){if(!e.removedNodes||-1===Array.prototype.indexOf.call(e.removedNodes,p))return!1;N()}))).observe(o,{childList:!0,subtree:!0,attributes:!1,characterData:!1}),a&&(a.forEach(function(t,r){return s(r,t.call(r,e,n))}),a=void 0),p}function N(){return u&&u.forEach(e=>e.call(p)),p&&(p.remove(),h=[]),f&&f.disconnect(),f=void 0,u=void 0,s=void 0,l=void 0,p=void 0,c=void 0,m=void 0,y=void 0,null}function O(e){return u||(u=new Set),u.add(e),m}function w(e){e?(b.splice(b.length+1+e),b[b.length-1]=g):b.push(g)}function j(){return h[b[b.length-2]]||d}function S(){const e={},t=[],n=new Map,r=new Map,i=new Map;let l=0;return{register:function(t,o,s){Object.assign(e,o);const l=u(n,t)+"_"+u(r,s),c=Object.keys(o);for(let e,t=0,n=c.length;t<n;t++)e=c[t],i.has(e)?i.get(e).push(l):i.set(e,[l]);return s.call(t,o)||{}},registerComponent:function(e){-1===t.indexOf(e)&&t.push(e)},update:function(l){const u="function"==typeof o?o(l):l;let a=!1;for(let e=0,n=t.length;e<n;e++)t[e](u)&&!a&&(a=!0);if(!i.size)return a;const f=Object.keys(u).filter(t=>i.has(t)&&e[t]!==u[t]),d=f.length;if(!d)return a;Object.assign(e,u);const p=[];for(let e,t=0;t<d;t++)for(let n,r=0,o=(e=i.get(f[t])).length;r<o;r++)n=e[r],-1===p.indexOf(n)&&p.push(n);for(let e=0,t=p.length;e<t;e++)h(p[e]);return!0;function h(t){const[o,i]=t.split("_").map(Number),l=n.get(o),u=r.get(i).call(l,e)||{};if(null===l.parentNode)return c(o,i,f);s(l,u)}},getData:function(){return e},unregister:c};function c(e,t,o){let s=0;function l(t){return Number(t.split("_")[0])!==e}n.delete(e),i.forEach(function(e,n){if(-1===o.indexOf(n))return e.forEach(function(e){Number(e.split("_")[1])===t&&(s+=1)});1===e.length?i.delete(n):i.set(n,e.filter(l))}),s||r.delete(t)}function u(e,t){let n=-1;return e.forEach(function(e,r){-1===n&&e===t&&(n=r)}),-1!==n?n:(n=l++,e.set(n,t),n)}}function C(e){return!!c&&c.update("function"==typeof e?e(c.getData()):e)}},t.componentListener=function(e,...t){const n=["oninit","onmount","onupdate"],r=n.indexOf((/^on/g.test(e)?"":"on")+e);if(-1===r)throw new Error(`Unsupported event name '${e}'!`);return Object.freeze([n[r],t])},t.assign=function(e,...t){const n=Object.assign({},...t),r=Object.keys(n);for(let t,o,i=0,s=r.length;i<s;i++)if(void 0!==(o=n[t=r[i]]))switch(t){case"style":if("string"==typeof o)e.setAttribute("style",o);else for(let t,n=0,r=Object.keys(o),i=r.length;n<i;n++)t=r[n],e.style.setProperty(t,o[t]);break;case"style_vars":for(let t,n=0,r=Object.keys(o),i=r.length;n<i;n++)t=r[n],e.style.setProperty(t,o[t]);break;case"classList":if(!e[t].toggle)break;for(let t,n,r=0,i=Object.keys(o),s=i.length;r<s;r++)-1===(n=o[t=i[r]])?e.classList.toggle(t):e.classList.toggle(t,Boolean(n));break;case"dataset":for(let t,n=0,r=Object.keys(o),i=r.length;n<i;n++)t=r[n],e.dataset[t]=o[t];break;case"href":e.setAttribute(t,o);break;default:e[t]=o}else Reflect.has(e,t)&&Reflect.deleteProperty(e,t);return e},t.assignNS=function(e,t,...n){const r=/^on[a-z]+/,o=Object.assign({},...n),i=Object.keys(o);for(let e,n,s=0,l=i.length;s<l;s++)if(void 0!==(n=o[e=i[s]]))switch(e){case"textContent":t.appendChild(document.createTextNode(n));break;case"style":if("string"==typeof n)t.setAttributeNS(null,"style",n);else for(let e,r=0,o=Object.keys(n),i=o.length;r<i;r++)e=o[r],t.style.setProperty(e,n[e]);break;case"style_vars":for(let e,r=0,o=Object.keys(n),i=o.length;r<i;r++)e=o[r],t.style.setProperty(e,n[e]);break;case"className":t.setAttributeNS(null,"class",n);break;case"classList":if(!t[e].toggle)break;for(let e,r,o=0,i=Object.keys(n),s=i.length;o<s;o++)-1===(r=n[e=i[o]])?t.classList.toggle(e):t.classList.toggle(e,Boolean(r));break;case"xlink:href":t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;default:r.test(e)?t[e]=n:t.setAttributeNS(null,e,n)}else t.hasAttributeNS(null,e)&&t.removeAttributeNS(null,e);return t},e.$dom=t}init(window);</script>
    <script type="text/javascript" src="$dom_svg-min.js?v=0.1.1"></script>
    <style>
        body{
            color: #eeeeee;
            background: #2b2b2b;
            padding: 0 0 1em 0;
        }
        a{
            color: #b8b8ff;
        }
        a:hover{
            color: white;
        }
        summary {
            cursor: pointer;
        }
        article{
            width: 80%;
            min-width: 75em;
            max-width: 85em;
            margin: auto;
        }
        h1, h2 {
            background: #222;
            border: 1px solid #222;
            padding: .5em;
            margin-left: -.5em;
        }
        h2:target {
            border-color: currentColor;
        }
        p{
            font-size: 1.1em;
        }
        .notes{
            margin-top: .25em;
            font-size: .75em;
        }
        input, button {
            background: rgba(0,0,0,1);
            border: 1px solid #97f497;
            color: #ffffff;
            padding: .25em .5em;
            margin: 0 0 .25em 0;
        }
        input:hover, button:hover, input:focus, button:focus {
            border-color: currentColor;
        }
        [contenteditable=""]{
            display: block;
            font-family: "Lucida Console", Monaco, monospace;
            font-size: .75em;
            line-height: 1.5em;
            font-weight: bold;
            white-space: break-spaces;
            padding: 1rem;
            margin-top: -.25rem;
            border: .25rem dotted #97f497;
            background: #222;
        }
        [contenteditable=""]:before{
            content: "JavaScript (editable):";
            padding-bottom: 1em;
            color: #97f497;
            font-weight: bold;
            display: block;
            font-size: .8rem;
        }
        style[contenteditable=""]:before{
            content: "CSS (editable)";
        }
        @media screen and (max-width: 640px){
            article{
                width: 90%;
                min-width: initial;
            }
            [contenteditable=""] {
                white-space: pre;
                overflow: scroll;
                border-right-style: outset;
            }
        }
        .output{
            padding: 1rem;
            margin: 0;
            border: .25rem dotted #f0e09a;
        }
        .output:before{
            content: "Output:";
            color: #f0e09a;
            font-weight: bold;
            display: block;
            padding-bottom: 1.5rem;
        }
        .example_red_color{ color: #ff9b9b; }
        .example_blue_color{ color: #36c7ff; }
    </style>
</head>
<body>
    <article>
        <h1>$dom_svg — Examples</h1>
        <a href="https://github.com/jaandrle/dollar_dom_svg">⇠ Go back to GitHub repository</a>
        <h2 id="heading_content">Content</h2>
        <ul class="content"></ul>
        <script>
            function onKeyup(script, id){
                const el= document.getElementById(id);
                $dom.empty(el);
                eval(script.textContent);
            }
        </script>
        
        
        
        
        <p>TEST</p>
        <style style="margin-bottom: -.25rem;" contenteditable="">
            .C__chart, .C__chartDataLabel{
                --chart-data-color: 240, 223, 94;
            }
            .C__chart{
                width: 50%;
                margin: 0 25%;
                fill: white;
                stroke: white;
                font-size: 5px;
                stroke-width: 1.5;
            }
            .C__chart *{
                vector-effect: non-scaling-stroke;
            }
            .C__chartAxeX{
                text-anchor: middle;
            }
            .C__chartAxeY{
                text-anchor: end;
            }
            #data_marker{
                stroke-width: 3;
            }
            .C__chartDataLabel{
                width: 15rem;
                font-size: 5px;
            }
            .C__chartDataLabel text{
                fill: white;
            }
        </style>
        <div class="output" id="example_element_001"></div>
        <script onkeyup="onKeyup(this, 'example_element_001')" contenteditable="">
        (function(element_id){
            //EXAMPLE START
        
            const container= document.getElementById(element_id);
            simpleSVGChart({ dataX: [ 0, 2, 3, 4, 6 ], dataY: [ -2, -5, 1, 0, 20 ] }).mount(container);
            simpleSVGChartDataLabel().mount(container);
        
            function simpleSVGChart({ dataX, dataY }){
                const /* helpers */
                    { min, max }= Math,
                    { getAreasSizes, getDataMetric, getAxeXParams, getAxeYParams, dataToPolylinePoints }= $dom_svg.chart_helpers,
                    { addAxeWrapper, addAxeLine, addLabelsTicksForAxeX, addLabelsTicksForAxeY, addCanvasWrapper }= $dom_svg.chart_parts;
                const /* chart global params */
                    [ viewBox, axis, chart ]= getAreasSizes([ 15, 8 ]),
                    metric= getDataMetric(chart, [ max(...dataX), max(...dataY) ], [ min(0, ...dataX), min(0, ...dataY) ]);
                const /* axis params */
                    size= 2.5,
                    axe_x= getAxeXParams(axis, chart, metric, { size }),
                    axe_y= getAxeYParams(axis, chart, metric, { step: 5, size, labelMap: t=> `${t}°C` });
                const { add, component, share }= $dom.component("svg", { className: "C__chart", viewBox });
                    component(addAxeWrapper(axe_x));
                        component(addAxeLine(axe_x));
                        component(addLabelsTicksForAxeX(axe_x), -1);
                    component(addAxeWrapper(axe_y), -2);
                        component(addAxeLine(axe_y));
                        component(addLabelsTicksForAxeY(axe_y), -1);
                    component(addCanvasWrapper({ axis, chart }), -2);
                        add("polyline", Object.assign({ points: dataToPolylinePoints({ metric, dataX, dataY }), stroke: "rgb(var(--chart-data-color))", fill: "none" }, markerReference("data_marker")));
                    add("defs", null, -2);
                        component(markerComponent({ id: "data_marker", fill: "rgba(var(--chart-data-color), .25)", stroke: "rgb(var(--chart-data-color))" }))
                return share;
                
                function markerReference(id){
                    const url= `url(#${id})`;
                    return { "marker-start": url, "marker-mid": url, "marker-end": url };
                }
                function markerComponent({ id, fill, stroke, size= 3.5 }){
                    const { add, share }= $dom.component("marker", {
                        id, fill, stroke,
                        viewBox: "0 0 10 10", refX: 5, refY: 5,
                        markerWidth: size, markerHeight: size
                    }, { namespace_group: "SVG" });
                        add("circle", { cx: 5, cy: 5, r: 4 });
                    return share;
                }
            }
            function simpleSVGChartDataLabel(){
                const dy= "4%";
                const { add, share }= $dom.component("svg", { className: "C__chartDataLabel", viewBox: "0 0 50 30" });
                    add("polyline", { points: "0,10 10,10 20,10", stroke: "rgb(var(--chart-data-color))", fill: "none", "marker-mid": "url(#data_marker)" });
                    add("text", { textContent: "Value1", x: 25, y: 10, dy }, -1);
                    add("polyline", { points: "0,20 10,20 20,20", stroke: "grey", fill: "none" }, -1);
                    add("text", { textContent: "Value2", x: 25, y: 20, dy }, -1);
                return share;
            }
            //EXAMPLE END
        })("example_element_001");
        </script>
        <p class="notes"><a href="https://github.com/jaandrle/dollar_dom_svg/blob/master/docs/examples.html#L159" target="_blank">View with highliting (link to source of this file)</a></p>

        
        <p>TEST</p>
        <style style="margin-bottom: -.25rem;" contenteditable="">
            .C__thermometer{
                height: 10rem;
            }
        </style>
        <div class="output" id="example_element_002"></div>
        <script onkeyup="onKeyup(this, 'example_element_002')" contenteditable="">
        (function(element_id){
            //EXAMPLE START
        
            const container= document.getElementById(element_id);
            //$dom_svg.global_defs.mount(container); example reload is async!!
            thermometerComponent({ temperature: 25 }).mount(container);
            thermometerComponent({ temperature: 5 }).mount(container);
        
            function thermometerComponent({ temperature= 25, className= "C__thermometer" }){
                const range= [ 5, 25 ];
                const { min, max }= Math;
                temperature= max(range[0], min(temperature, range[1]));
                const /* create SVG defs */
                    mask_id= $dom_svg.global_defs.add("thermometer_mask_"+temperature, defineMask.bind(null, { size: temperature })),
                    gradient_id= $dom_svg.global_defs.add("thermometer_gradient", defineLinearGradient);
                const { add, component, share }= $dom.component("svg", { viewBox: `0 0 20 40`, fill: "none", className });
                    component(border());
                    add("path", { 
                        fill: `url(#${gradient_id})`, mask: `url(#${mask_id})`,
                        d: "M3 30.9724C3 29.0972 3.86664 27.3558 5.33336 26.2173L6.33336 25.4136V5.67891C6.33336 4.20552 7.53336 3 9 3C10.4666 3 11.6666 4.20552 11.6666 5.67891V25.4137L12.6666 26.2174C14.1333 27.3559 15 29.0972 15 30.9725C15 34.3211 12.3334 37 9 37C5.66664 37 3 34.3211 3 30.9724Z"
                    }, -1);
                return share;
        
                function border(color= "#A9A9A9"){
                    return $dom.component("path", {
                        fill: color,
                        'fill-rule': "evenodd",
                        'clip-rule': "evenodd",
                        d: "M0 30.6666C0 35.8 4.04999 40 9 40C13.95 40 18 35.8 18 30.6667C18 27.8667 16.8429 25.3334 14.7857 23.5334V6C14.7857 2.66664 12.2143 0 9 0C5.7857 0 3.2143 2.66664 3.2143 6V23.5333C1.15714 25.3333 0 27.8666 0 30.6666ZM4.50004 6C4.50004 3.4 6.49286 1.33336 9 1.33336C11.5071 1.33336 13.5 3.4 13.5001 6V23.8666C13.5001 24.0666 13.6286 24.2666 13.7572 24.4C15.6215 25.9333 16.7143 28.2 16.7143 30.6666C16.7143 35.0666 13.2429 38.6666 9.00008 38.6666C4.75723 38.6666 1.28581 35.0666 1.28581 30.6666C1.28581 28.2 2.37861 25.9334 4.24292 24.4C4.43578 24.2666 4.50004 24.0666 4.50004 23.8666V6Z"
                    }, { namespace_group: "SVG" }).share;
                }
            }
            function defineLinearGradient(){
                const { add, share }= $dom.component("linearGradient", { x1: 3, y1: 3, x2: 3, y2: 37, gradientUnits: "userSpaceOnUse" }, { namespace_group: "SVG" });
                    add("stop", { 'stop-color': "#D01F29" });
                    add("stop", { 'stop-color': "#B2B2B2", offset: "0.507707" }, -1);
                    add("stop", { 'stop-color': "#046FBC", offset: "1" }, -1);
                return share;
            }
            function defineMask({ size= 25, fill= "white" }){
                const { add, share }= $dom.component("mask", {
                    'mask-type': "alpha", maskUnits: "userSpaceOnUse",
                    x: 0, y: -1.65*size+43.25, /* linearni regrese */
                    width: 20, height: 1.65*size-6.25 /* linearni regrese */
                }, { namespace_group: "SVG" });
                    add("rect", { height: "100%", width: "100%", fill });
                return share
            }
        
        //EXAMPLE END
        })("example_element_002");
        </script>
        <p class="notes"><a href="https://github.com/jaandrle/dollar_dom_svg/blob/master/docs/examples.html#L228" target="_blank">View with highliting (link to source of this file)</a></p>


        <script>
            document.addEventListener("paste", function enableInScriptTags(ev){
                ev.preventDefault();
                document.execCommand('insertText', false, ev.clipboardData.getData('text/plain'));
            });
            document.addEventListener("keydown", function enableInScriptTags(ev){
                if(ev.target.tagName!=="SCRIPT"&&ev.target.tagName!=="STYLE") return false;
                const { keyCode }= ev;
                if(keyCode!==9&&keyCode!==13) return false;

                ev.preventDefault();
                document.execCommand('insertText', false, keyCode===9 ? "    " : "\n                ");
            });
            let h2_counter= 0;
            const content_ul= document.getElementsByClassName('content')[0];
            [ ...document.getElementsByTagName('h2') ].forEach(function(el){
                const textContent= el.textContent;
                if(textContent==="Content") return false;
                const id= "heading_"+h2_counter++;
                contentH2({ textContent, id }).mount(el, "replace");
                contentLI({ textContent, id }).mount(content_ul);
            });
            function contentLI({ textContent, id }){
                const href= "#"+id;
                const { add, share }= $dom.component("LI", null);
                    add("A", { textContent, href });
                return share;
            }
            function contentH2({ textContent, id }){
                const { add, share }= $dom.component("H2", { id });
                    add("A", { textContent: "⇡", href: "#heading_content" });
                    add("SPAN", { textContent: " "+textContent }, -1);
                return share;
            }
        </script>
    </article>
</body>
</html>